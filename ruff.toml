# Ruff configuration for PCAP Sentry
# Fast Python linter and formatter

# Target Python 3.10+ (project supports 3.10, 3.11, 3.12)
target-version = "py310"

# Line length to match project style
line-length = 120

[lint]
# Enable recommended rule sets
select = [
    "E",     # pycodestyle errors
    "W",     # pycodestyle warnings
    "F",     # pyflakes
    "I",     # isort (import sorting)
    "N",     # pep8-naming
    "UP",    # pyupgrade (modern Python idioms)
    "B",     # flake8-bugbear (likely bugs)
    "C4",    # flake8-comprehensions
    "SIM",   # flake8-simplify
    "RET",   # flake8-return
    "ARG",   # flake8-unused-arguments
    "PTH",   # flake8-use-pathlib
    "ERA",   # eradicate (commented-out code)
    "PL",    # pylint
    "PERF",  # perflint (performance anti-patterns)
    "RUF",   # ruff-specific rules
]

# Ignore specific rules that may not apply or are too strict
ignore = [
    "E501",    # Line too long (handled by formatter)
    "PLR0913", # Too many arguments to function call
    "PLR0912", # Too many branches
    "PLR0915", # Too many statements
    "PLR2004", # Magic value used in comparison
    "PLC0415", # Lazy imports are intentional in large GUI module
    "N802",    # Function name should be lowercase (GUI callbacks use mixed case)
    "N803",    # Argument name should be lowercase (tkinter uses mixed case)
    "N806",    # Variable in function should be lowercase (tkinter uses mixed case)
    "ARG001",  # Unused function argument (common in GUI event handlers)
    "ARG002",  # Unused method argument (common in GUI callbacks)
    "B008",    # Do not perform function call in argument defaults (tkinter requires this)
    "ERA001",  # Commented-out code retained for troubleshooting
    "PTH",     # os.path usage retained for legacy Windows paths
    "PLW0603", # Globals used for tkinter state and feature flags
    "PLW1510", # subprocess.run without check=True handled explicitly
    "SIM108",  # Use ternary operator (sometimes less readable)
    "RET504",  # Unnecessary assignment before return (can improve readability)
]

# Allow autofix for all enabled rules
fixable = ["ALL"]
unfixable = []

# Exclude patterns
exclude = [
    ".git",
    ".venv",
    "venv",
    "__pycache__",
    "build",
    "dist",
    "installer",
    "htmlcov",
    ".pytest_cache",
]

[lint.per-file-ignores]
# Tests can use assert statements and have longer functions
"tests/*" = ["S101", "PLR0915"]
"Python/pcap_sentry_gui.py" = [
    "B007",
    "B904",
    "E402",
    "ERA001",
    "F401",
    "I001",
    "PERF",
    "PTH",
    "PLC0415",
    "PLR0911",
    "PLW0603",
    "PLW1510",
    "RUF002",
    "RUF003",
    "RUF012",
    "SIM105",
    "W293",
]
"Python/enhanced_ml_trainer.py" = ["PTH", "PLR0911"]
"Python/update_checker.py" = ["PLR0911", "SIM105", "W293"]
"tests/test_stability.py" = ["PERF203"]

[format]
# Use double quotes for strings
quote-style = "double"

# Use Unix line endings
line-ending = "auto"

# Indent with 4 spaces
indent-style = "space"

# Skip string normalization to preserve existing string quotes
skip-magic-trailing-comma = false

[lint.isort]
# Import sorting configuration
known-first-party = ["pcap_sentry_gui", "threat_intelligence", "update_checker", "enhanced_ml_trainer"]
